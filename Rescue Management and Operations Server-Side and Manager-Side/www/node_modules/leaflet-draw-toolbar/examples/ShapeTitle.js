L.ShapeTitle = L.Toolbar2.Action.extend({
	options: {
		toolbarIcon: {}
	},

	initialize: function(map, shape, options) {
		this._map = map;
		this._shape = shape;
		L.setOptions(this, options);
		L.Toolbar2.Action.prototype.initialize.call(this, map, options);
	},
	
	addHooks: function() {
		this.disable();
	},

	_createIcon: function(toolbar, container, args) {
		var changeTitleForm = L.DomUtil.create('form');

		var title = L.DomUtil.create('input'),
			width, height;
		title.type = 'text';	
		
		var changeTitle = L.DomUtil.create('input'),
			width, height;
		changeTitle.type = 'submit';
		changeTitle.value = 'Change Area Name';
		
		L.Toolbar2.Action.prototype._createIcon.call(this, toolbar, container, args);

		L.extend(changeTitleForm.style, {
			backgroundColor: 'white'
		});
		
		L.extend(title.style, {
			backgroundColor: 'white',
			width: '120px',
			height: '20px'
		});
		
		L.extend(changeTitle.style, {
			backgroundColor: 'Green',
			width: '120px',
			height: '20px'
		});

		changeTitleForm.appendChild(title);
		changeTitleForm.appendChild(changeTitle);
		this._link.appendChild(changeTitleForm);

		L.DomEvent.on(this._link.children[0][1], 'click', function(event){
			event.preventDefault();
			if(this._link.children[0][0].value != "")
				this._shape._popup._content = this._link.children[0][0].value;
			this._map.removeLayer(this.toolbar.parentToolbar);
		}, this);
	}
	
});